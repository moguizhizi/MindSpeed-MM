model: /home/project/Ascend_Community/MindSpeed-MM/configs/model/qwen2.5vl_3b.json
data_config:
  prompt_key: problem
  answer_key: answer
  image_key: images
  truncation: left
  shuffle: false
  max_pixels: 4194304
  min_pixels: 262144
megatron_training:
  model: qwen2.5vl_3b
  use_fused_rmsnorm: false
  normalization: RMSNorm
  use_mcore_models: true
  sequence_parallel: false
  use_flash_attn: true
  no_masked_softmax_fusion: true
  attention_softmax_in_fp32: true
  no_gradient_accumulation_fusion: true
  use_fused_swiglu: false
  swiglu: true
  bf16: true
  use_distributed_optimizer: true
  tokenizer_type: PretrainedFromHF
  tokenizer_name_or_path: /data/llm_model/modelscope/Qwen/Qwen2.5-VL-3B-Instruct
  global_batch_size: 256
  seq_length: 512
  save_interval: 50
  train_iters: 1000
  stage: ray_grpo
  attention_dropout: 0.0
  init_method_std: 0.01
  hidden_dropout: 0.0
  distributed_backend: nccl
  no_shared_storage: true
  variable_seq_lengths: true
  norm_epsilon: 1.0e-06
  dataset_additional_keys:
  - input_ids
  - input_ids_length
  - attention_mask
  - position_ids
  data_path: /root/.cache/huggingface/datasets/hiyouga___geometry3k/default/0.0.0/fd21e533e1e50d0662a2bf7b223e60511bd5f8b7/
  split: 100,0,0
  use_deter_comp: true
actor_config:
  model: qwen2.5vl_3b
  micro_batch_size: 1
  actor_image_embeds_micro_batch_size: 1
  actor_log_prob_micro_batch_size: 8
  ref_log_prob_micro_batch_size: 8
  tensor_model_parallel_size: 1
  pipeline_model_parallel_size: 1
  lr: 1.0e-06
  lr_decay_style: constant
  min_lr: 0.0
  weight_decay: 0.01
  lr_warmup_fraction: 0.0
  clip_grad: 1.0
  adam_beta1: 0.9
  adam_beta2: 0.999
  initial_loss_scale: 4096
  finetune: true
  load: /path/qwen2_5_vl_3b_tp1pp1
  save: ./ckpt
  no_load_optim: true
  no_load_rng: true
  num_workers: 8
rl_config:
  guarantee_order: true
  blocking: true
  gamma: 1.0
  lam: 0.95
  adv_estimator: group_norm
  kl_penalty: kl
  kl_ctrl_type: fixed
  init_kl_coef: 0.01
  mini_batch_size: 160
  max_prompt_length: 1024
  epochs: 1
  clip_ratio: 0.2
  entropy_coeff: 0.0
  shuffle_mini_batch: false
  n_samples_per_prompt: 5
  rule_reward: true
  num_cpus_for_local_task: 1.0
  num_cpus_for_placement_group: 8
  use_integrated_worker: true
  reuse_image_embeds: false
  actor_resource:
    num_npus: 8
generate_config:
  limit_mm_image_per_prompt: 1
  micro_batch_size: 32
  trust_remote_code: true
  infer_tensor_parallel_size: 1
  infer_pipeline_parallel_size: 1
  infer_expert_parallel_size: 1
  max_num_seqs: 32
  max_model_len: 3072
  dtype: bfloat16
  gpu_memory_utilization: 0.8
  offload_train_optimizer: true
  offload_train_grad: true
  offload_train_param: true
  sampling_config:
    logprobs: 0
    max_tokens: 2048
    top_p: 1.0
    top_k: -1
    min_p: 0.0
    temperature: 1.0
    detokenize: false
    seed: 1234
